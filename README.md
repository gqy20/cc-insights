# Claude Code Dashboard

åŸºäº Go + go-echarts çš„ Claude Code ä½¿ç”¨æ•°æ®å¯è§†åŒ– Dashboardï¼Œæ”¯æŒæ—¶é—´èŒƒå›´ç­›é€‰å’Œå¹¶å‘è§£æä¼˜åŒ–ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ“Š **å¯è§†åŒ–å›¾è¡¨**
  - æ¯æ—¥æ´»åŠ¨è¶‹åŠ¿ï¼ˆæŠ˜çº¿å›¾ï¼‰
  - Slash Commands ä½¿ç”¨ç»Ÿè®¡ï¼ˆæŸ±çŠ¶å›¾ï¼‰
  - 24å°æ—¶æ´»åŠ¨åˆ†å¸ƒï¼ˆæŸ±çŠ¶å›¾ï¼‰
  - MCP å·¥å…·è°ƒç”¨ç»Ÿè®¡ï¼ˆé¥¼å›¾ï¼‰

- â±ï¸ **æ—¶é—´èŒƒå›´ç­›é€‰**
  - å¿«æ·é¢„è®¾ï¼š7å¤©ã€30å¤©ã€90å¤©ã€å…¨éƒ¨
  - è‡ªå®šä¹‰èŒƒå›´ï¼šé€‰æ‹©èµ·æ­¢æ—¥æœŸ
  - å®æ—¶ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤º

- ğŸš€ **æ€§èƒ½ä¼˜åŒ–**
  - æ‰¹é‡å¤„ç†ï¼ˆ1000æ¡/æ‰¹ï¼‰
  - Producer-Consumer å¹¶å‘æ¨¡å¼
  - Worker pool å¹¶å‘æ§åˆ¶
  - å¤§ç¼“å†²åŒºæ‰«æï¼ˆ64KB-1MBï¼‰

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### 1. æ„å»º

```bash
cd dashboard
make build
```

### 2. è¿è¡Œ

```bash
# ä½¿ç”¨é»˜è®¤æ•°æ®ç›®å½•ï¼ˆå½“å‰ç›®å½•ä¸‹çš„ dataï¼‰
./cc-dashboard

# æŒ‡å®šæ•°æ®ç›®å½•
./cc-dashboard -data /path/to/data

# æŒ‡å®šç›‘å¬åœ°å€
./cc-dashboard -addr :9090
```

### 3. è®¿é—®

æ‰“å¼€æµè§ˆå™¨è®¿é—®:
- é¦–é¡µ: http://localhost:8080
- Dashboard: http://localhost:8080/dashboard
- API: http://localhost:8080/api/data?preset=7d

## ğŸ“ æ•°æ®ç›®å½•ç»“æ„

```
data/
â”œâ”€â”€ history.jsonl        # å‘½ä»¤å†å² (2.5MB, 10K+æ¡)
â”œâ”€â”€ stats-cache.json     # ç»Ÿè®¡ç¼“å­˜ (12.5KB)
â””â”€â”€ debug/               # Debug æ—¥å¿—ç›®å½• (1.1GB, 2848ä¸ªæ–‡ä»¶)
```

## ğŸ› ï¸ Make å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `make build` | æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶ |
| `make build-compress` | æ„å»ºå¹¶ä½¿ç”¨ UPX å‹ç¼© |
| `make run` | æ„å»ºå¹¶è¿è¡Œ |
| `make run-dev` | å¼€å‘æ¨¡å¼è¿è¡Œï¼ˆä½¿ç”¨ä¸Šçº§ç›®å½•çš„ dataï¼‰ |
| `make deps` | å®‰è£…ä¾èµ– |
| `make clean` | æ¸…ç†æ„å»ºæ–‡ä»¶ |
| `make bench` | æ€§èƒ½æµ‹è¯•ï¼ˆæœ€è¿‘7å¤©ï¼‰ |
| `make bench-all` | æ€§èƒ½æµ‹è¯•ï¼ˆå…¨éƒ¨æ•°æ®ï¼‰ |
| `make release` | æ„å»ºå¤šå¹³å°å‘å¸ƒç‰ˆæœ¬ |
| `make install-upx` | å®‰è£… UPX å‹ç¼©å·¥å…· |

## ğŸ“¡ API æ¥å£

### GET /api/data

è·å–ç­›é€‰åçš„æ•°æ®ï¼š

```
GET /api/data?preset=7d
GET /api/data?preset=custom&start=2025-12-01&end=2026-01-08
```

**å‚æ•°ï¼š**
- `preset`: `7d` | `30d` | `90d` | `all` | `custom`
- `start`: å¼€å§‹æ—¥æœŸ (è‡ªå®šä¹‰èŒƒå›´æ—¶ä½¿ç”¨ï¼Œæ ¼å¼: `2025-12-01`)
- `end`: ç»“æŸæ—¥æœŸ (è‡ªå®šä¹‰èŒƒå›´æ—¶ä½¿ç”¨ï¼Œæ ¼å¼: `2026-01-08`)

**å“åº”ï¼š**

```json
{
  "success": true,
  "data": {
    "timestamp": "2026-01-08 16:02:07",
    "time_range": {
      "preset": "7d",
      "start": "2026-01-01",
      "end": "2026-01-08"
    },
    "commands": [
      {"Command": "/tdd", "Count": 115},
      {"Command": "/gh", "Count": 31}
    ],
    "hourly_counts": {
      "10": 53, "11": 44, "15": 137
    },
    "daily_trend": {
      "dates": ["2026-01-02", "2026-01-03"],
      "counts": [7765, 7849]
    },
    "mcp_tools": [
      {"Tool": "search_web", "Server": "jina", "Count": 1543}
    ]
  }
}
```

### GET /api/stats

æ—§ç‰ˆ APIï¼ˆä¿æŒå…¼å®¹ï¼‰ï¼Œè¿”å›å…¨éƒ¨æ•°æ®ã€‚

## ğŸ”§ å‘½ä»¤è¡Œå‚æ•°

```
-data <path>    æ•°æ®ç›®å½•è·¯å¾„ï¼ˆé»˜è®¤: ./dataï¼‰
-addr <addr>    ç›‘å¬åœ°å€ï¼ˆé»˜è®¤: :8080ï¼‰
```

## ğŸ“Š æ€§èƒ½æµ‹è¯•ç»“æœ

### æœ€è¿‘ 7 å¤©æ•°æ®

```
history.jsonl: 0.05s
debug/ æ—¥å¿—:   5.22s
æ€»è®¡:          ~5.3s
```

### å…¨éƒ¨æ•°æ®

```
history.jsonl: 0.05s
debug/ æ—¥å¿—:   4.96s
æ€»è®¡:          ~5.0s
```

**æµ‹è¯•ç¯å¢ƒï¼š** 72æ ¸ CPUï¼Œ2.2G æ•°æ®

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

- **Go 1.21+** - åç«¯è¯­è¨€
- **go-echarts v2** - å›¾è¡¨æ¸²æŸ“
- **net/http** - Web æœåŠ¡å™¨
- **ECharts** - å‰ç«¯å›¾è¡¨åº“ï¼ˆCDNï¼‰

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
dashboard/
â”œâ”€â”€ cc-dashboard       # å¯æ‰§è¡Œæ–‡ä»¶ (8.8MB)
â”œâ”€â”€ api.go             # API æ¥å£ï¼ˆæ”¯æŒæ—¶é—´è¿‡æ»¤ï¼‰
â”œâ”€â”€ concurrent.go      # ä¼˜åŒ–çš„å¹¶å‘å¤„ç†æ¨¡å—
â”œâ”€â”€ filter.go          # æ—¶é—´è¿‡æ»¤é€»è¾‘
â”œâ”€â”€ parser.go          # æ•°æ®è§£æï¼ˆæ”¯æŒè¿‡æ»¤ï¼‰
â”œâ”€â”€ charts.go          # å›¾è¡¨ç”Ÿæˆ
â”œâ”€â”€ main.go            # Web æœåŠ¡å™¨å’Œè·¯ç”±
â”œâ”€â”€ config.go          # é…ç½®ç®¡ç†
â”œâ”€â”€ static/
â”‚   â””â”€â”€ app.js         # å‰ç«¯äº¤äº’ï¼ˆAJAX åŠ è½½ï¼‰
â”œâ”€â”€ benchmark.go       # æ€§èƒ½æµ‹è¯•å·¥å…·
â”œâ”€â”€ Makefile           # æ„å»ºè„šæœ¬
â”œâ”€â”€ go.mod             # Go æ¨¡å—
â””â”€â”€ README.md          # æœ¬æ–‡ä»¶
```

## ğŸ¯ å¹¶å‘ä¼˜åŒ–è¯¦æƒ…

### history.jsonl è§£æ

**ä¼˜åŒ–æŠ€æœ¯ï¼š**
- æ‰¹é‡è¯»å–ï¼ˆ1000æ¡/æ‰¹ï¼‰
- Producer-Consumer æ¨¡å¼
- æœ¬åœ°èšåˆååˆå¹¶
- å‡å°‘é”ç«äº‰

**æ•ˆæœï¼š**
- å•çº¿ç¨‹ â†’ å¤šæ ¸å¹¶è¡Œ
- I/O ä¸è®¡ç®—é‡å 

### debug æ—¥å¿—è§£æ

**ä¼˜åŒ–æŠ€æœ¯ï¼š**
- æ–‡ä»¶æ—¶é—´è¿‡æ»¤ï¼ˆè§£æå‰ï¼‰
- ä¿¡å·é‡æ§åˆ¶ï¼ˆCPUæ ¸å¿ƒæ•° Ã— 4ï¼Œæœ€å¤š64ï¼‰
- å¤§ç¼“å†²åŒºæ‰«æï¼ˆ64KB-1MBï¼‰
- é¢„ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼

**æ•ˆæœï¼š**
- å¹¶å‘åº¦åŠ¨æ€è°ƒæ•´
- å†…å­˜å ç”¨ä¼˜åŒ–
- é¿å…è§£ææ— ç”¨æ–‡ä»¶

## ğŸ“¦ äºŒè¿›åˆ¶å¤§å°

| ç‰ˆæœ¬ | å¤§å° | è¯´æ˜ |
|------|------|------|
| æ™®é€šç‰ˆ | 8.8 MB | `make build` |
| UPX å‹ç¼© | ~4 MB | `make build-compress` |

## ğŸš€ å¼€å‘

```bash
# å®‰è£…ä¾èµ–
make deps

# å¼€å‘æ¨¡å¼è¿è¡Œ
make run-dev

# æ€§èƒ½æµ‹è¯•
make bench

# æ„å»ºå‹ç¼©ç‰ˆæœ¬
make build-compress
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®è·¯å¾„çµæ´»**: ä½¿ç”¨ `-data` å‚æ•°æŒ‡å®šä»»æ„æ•°æ®ç›®å½•
2. **æ— éœ€æ•°æ®åº“**: ç›´æ¥è¯»å– JSON å’Œæ—¥å¿—æ–‡ä»¶
3. **å¹¶å‘è§£æ**: debug æ—¥å¿—ä½¿ç”¨å¤šè¿›ç¨‹å¹¶å‘è§£æ
4. **å•æ–‡ä»¶éƒ¨ç½²**: æ‰€æœ‰ä¾èµ–ç¼–è¯‘è¿›å•ä¸€å¯æ‰§è¡Œæ–‡ä»¶
5. **æ—¶é—´ç­›é€‰**: æ”¯æŒå¤šç§æ—¶é—´èŒƒå›´é€‰æ‹©æ–¹å¼

## ğŸ”§ æ•…éšœæ’æŸ¥

### Dashboard æ— æ³•å¯åŠ¨

```bash
# æ£€æŸ¥æ•°æ®ç›®å½•
ls -la data/history.jsonl

# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :8080

# æŸ¥çœ‹æ—¥å¿—
./cc-dashboard -data ../data 2>&1 | tee debug.log
```

### å›¾è¡¨ä¸æ˜¾ç¤º

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)
2. æ£€æŸ¥ Console æ˜¯å¦æœ‰é”™è¯¯
3. æ£€æŸ¥ Network æ˜¯å¦æœ‰ API è¯·æ±‚å¤±è´¥

### æ•°æ®åŠ è½½æ…¢

```bash
# è¿è¡Œæ€§èƒ½æµ‹è¯•
make bench

# æ£€æŸ¥å¹¶å‘åº¦
nproc  # Linux ç³»ç»ŸCPUæ ¸å¿ƒæ•°
```

## ğŸ“„ License

MIT
