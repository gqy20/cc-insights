# cc-insights

> AI é©±åŠ¨çš„ Claude Code ä½¿ç”¨æ•°æ®åˆ†æå·¥å…· - å¯è§†åŒ–æ•°æ®ã€å‘ç°æ¨¡å¼ã€è·å–æ™ºèƒ½æ¨è

cc-insights æ˜¯ä¸€ä¸ªåŸºäº Go + go-echarts çš„ Claude Code ä½¿ç”¨æ•°æ®åˆ†æå·¥å…·ï¼Œé€šè¿‡å¯è§†åŒ–å›¾è¡¨å±•ç¤ºä½ çš„ä½¿ç”¨ç»Ÿè®¡ï¼Œå¹¶æ”¯æŒæ—¶é—´èŒƒå›´ç­›é€‰å’Œå¹¶å‘è§£æä¼˜åŒ–ã€‚

**æ ¸å¿ƒç‰¹ç‚¹ï¼š**
- **å•æ–‡ä»¶éƒ¨ç½²** - é™æ€èµ„æºåµŒå…¥äºŒè¿›åˆ¶ï¼Œ~2MB å®Œå…¨ä¾¿æº
- **é«˜æ€§èƒ½å¹¶å‘** - Producer-Consumer æ¨¡å¼ + Worker Pool
- **è·¨å¹³å°å…¼å®¹** - é™æ€é“¾æ¥æ„å»ºï¼Œæ— å¤–éƒ¨ä¾èµ–
- **AI åˆ†æ** - åŸºäºä½¿ç”¨æ•°æ®æä¾›æ™ºèƒ½æ´å¯Ÿå’Œæ¨èï¼ˆè§„åˆ’ä¸­ï¼‰

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ“Š **å¯è§†åŒ–å›¾è¡¨**
  - æ¯æ—¥æ´»åŠ¨è¶‹åŠ¿ï¼ˆæŠ˜çº¿å›¾ï¼‰
  - Slash Commands ä½¿ç”¨ç»Ÿè®¡ï¼ˆæŸ±çŠ¶å›¾ï¼‰
  - 24å°æ—¶æ´»åŠ¨åˆ†å¸ƒï¼ˆæŸ±çŠ¶å›¾ï¼‰
  - MCP å·¥å…·è°ƒç”¨ç»Ÿè®¡ï¼ˆé¥¼å›¾ï¼‰
  - ä¼šè¯ç»Ÿè®¡ï¼ˆæ€»æ¶ˆæ¯æ•°ã€ä¼šè¯æ•°ã€å·¥å…·è°ƒç”¨æ•°ï¼‰

- â±ï¸ **æ—¶é—´èŒƒå›´ç­›é€‰**
  - å¿«æ·é¢„è®¾ï¼š7å¤©ã€30å¤©ã€90å¤©ã€å…¨éƒ¨
  - è‡ªå®šä¹‰èŒƒå›´ï¼šé€‰æ‹©èµ·æ­¢æ—¥æœŸ
  - å®æ—¶ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤º

- ğŸ¤– **AI æ™ºèƒ½åˆ†æï¼ˆè§„åˆ’ä¸­ï¼‰**
  - **Commands æ¨è** - åŸºäºä½¿ç”¨æ¨¡å¼æ¨èå¯èƒ½æœ‰ç”¨çš„æ–°å‘½ä»¤
  - **MCP å·¥å…·æ¨è** - æ ¹æ®å·¥ä½œå†…å®¹æ¨èåˆé€‚çš„ MCP æœåŠ¡å™¨
  - **æ•ˆç‡æ´å¯Ÿ** - åˆ†æå·¥ä½œä¹ æƒ¯ï¼Œæä¾›ä¼˜åŒ–å»ºè®®
  - **æ¨¡å¼è¯†åˆ«** - å‘ç°é‡å¤æ“ä½œã€ä½¿ç”¨é«˜å³°ç­‰æ¨¡å¼

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### 1. æ„å»º

```bash
make build-static-compress  # é™æ€+UPXå‹ç¼©ï¼ˆ~2MBï¼Œé»˜è®¤æ¨èï¼‰
make build-static           # é™æ€é“¾æ¥ï¼ˆ~7MBï¼‰
make build                  # åŠ¨æ€é“¾æ¥ï¼ˆ~6MBï¼‰
```

### 2. è¿è¡Œ

```bash
# ä½¿ç”¨é»˜è®¤æ•°æ®ç›®å½•ï¼ˆå½“å‰ç›®å½•ä¸‹çš„ dataï¼‰
./cc-insights

# æŒ‡å®šæ•°æ®ç›®å½•
./cc-insights -data /path/to/data

# æŒ‡å®šç›‘å¬åœ°å€
./cc-insights -addr :9090
```

### 3. è®¿é—®

æ‰“å¼€æµè§ˆå™¨è®¿é—®:
- é¦–é¡µ: http://localhost:8080
- Dashboard: http://localhost:8080/dashboard
- API: http://localhost:8080/api/data?preset=7d

## ğŸ“ æ•°æ®ç›®å½•ç»“æ„

```
data/
â”œâ”€â”€ history.jsonl        # å‘½ä»¤å†å² (2.5MB, 10K+æ¡)
â”œâ”€â”€ stats-cache.json     # ç»Ÿè®¡ç¼“å­˜ (12.5KB)
â””â”€â”€ debug/               # Debug æ—¥å¿—ç›®å½• (1.1GB, 2848ä¸ªæ–‡ä»¶)
```

## ğŸ¨ Dashboard é¢„è§ˆ

![Dashboard Preview](docs/dashboard.png)

## ğŸ“¡ API æ¥å£

### GET /api/data

è·å–ç­›é€‰åçš„æ•°æ®ï¼š

```
GET /api/data?preset=7d
GET /api/data?preset=custom&start=2025-12-01&end=2026-01-08
```

**å‚æ•°ï¼š**
- `preset`: `7d` | `30d` | `90d` | `all` | `custom`
- `start`: å¼€å§‹æ—¥æœŸ (è‡ªå®šä¹‰èŒƒå›´æ—¶ä½¿ç”¨ï¼Œæ ¼å¼: `2025-12-01`)
- `end`: ç»“æŸæ—¥æœŸ (è‡ªå®šä¹‰èŒƒå›´æ—¶ä½¿ç”¨ï¼Œæ ¼å¼: `2026-01-08`)

**å“åº”ï¼š**

```json
{
  "success": true,
  "data": {
    "timestamp": "2026-01-08 16:02:07",
    "time_range": {
      "preset": "7d",
      "start": "2026-01-01",
      "end": "2026-01-08"
    },
    "commands": [
      {"Command": "/tdd", "Count": 115},
      {"Command": "/gh", "Count": 31}
    ],
    "hourly_counts": {
      "10": 53, "11": 44, "15": 137
    },
    "daily_trend": {
      "dates": ["2026-01-02", "2026-01-03"],
      "counts": [7765, 7849]
    },
    "mcp_tools": [
      {"Tool": "search_web", "Server": "jina", "Count": 1543}
    ],
    "sessions": {
      "total_messages": 15420,
      "total_sessions": 89,
      "total_tool_calls": 2341
    }
  }
}
```

### GET /api/stats

æ—§ç‰ˆ APIï¼ˆä¿æŒå…¼å®¹ï¼‰ï¼Œè¿”å›å…¨éƒ¨æ•°æ®ã€‚

## ğŸ”§ å‘½ä»¤è¡Œå‚æ•°

```
-data <path>    æ•°æ®ç›®å½•è·¯å¾„ï¼ˆé»˜è®¤: ./dataï¼‰
-addr <addr>    ç›‘å¬åœ°å€ï¼ˆé»˜è®¤: :8080ï¼‰
```

## ğŸ“Š æ€§èƒ½æµ‹è¯•ç»“æœ

### æœ€è¿‘ 7 å¤©æ•°æ®

```
history.jsonl: 0.05s
debug/ æ—¥å¿—:   5.22s
æ€»è®¡:          ~5.3s
```

### å…¨éƒ¨æ•°æ®

```
history.jsonl: 0.05s
debug/ æ—¥å¿—:   4.96s
æ€»è®¡:          ~5.0s
```

**æµ‹è¯•ç¯å¢ƒï¼š** 72æ ¸ CPUï¼Œ2.2G æ•°æ®

## ğŸš€ å¼€å‘

```bash
# å®‰è£…ä¾èµ–
make deps

# å¼€å‘æ¨¡å¼è¿è¡Œ
make run-dev

# è¿è¡Œæµ‹è¯•
make test

# æ€§èƒ½æµ‹è¯•
make bench
make bench-all

# æ„å»ºå‹ç¼©ç‰ˆæœ¬
make build-static-compress
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®è·¯å¾„çµæ´»**: ä½¿ç”¨ `-data` å‚æ•°æŒ‡å®šä»»æ„æ•°æ®ç›®å½•
2. **æ— éœ€æ•°æ®åº“**: ç›´æ¥è¯»å– JSON å’Œæ—¥å¿—æ–‡ä»¶
3. **å¹¶å‘è§£æ**: debug æ—¥å¿—ä½¿ç”¨å¤šè¿›ç¨‹å¹¶å‘è§£æ
4. **å•æ–‡ä»¶éƒ¨ç½²**: æ‰€æœ‰ä¾èµ–ç¼–è¯‘è¿›å•ä¸€å¯æ‰§è¡Œæ–‡ä»¶
5. **æ—¶é—´ç­›é€‰**: æ”¯æŒå¤šç§æ—¶é—´èŒƒå›´é€‰æ‹©æ–¹å¼
6. **é™æ€é“¾æ¥**: é»˜è®¤æ„å»ºæ— å¤–éƒ¨ä¾èµ–ï¼Œå¯åœ¨ä»»æ„ Linux ç³»ç»Ÿè¿è¡Œ

## ğŸ”§ æ•…éšœæ’æŸ¥

### Dashboard æ— æ³•å¯åŠ¨

```bash
# æ£€æŸ¥æ•°æ®ç›®å½•
ls -la data/history.jsonl

# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :8080

# æŸ¥çœ‹æ—¥å¿—
./cc-insights -data ../data 2>&1 | tee debug.log
```

### å›¾è¡¨ä¸æ˜¾ç¤º

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)
2. æ£€æŸ¥ Console æ˜¯å¦æœ‰é”™è¯¯
3. æ£€æŸ¥ Network æ˜¯å¦æœ‰ API è¯·æ±‚å¤±è´¥

### æ•°æ®åŠ è½½æ…¢

```bash
# è¿è¡Œæ€§èƒ½æµ‹è¯•
make bench

# æ£€æŸ¥å¹¶å‘åº¦
nproc  # Linux ç³»ç»ŸCPUæ ¸å¿ƒæ•°
```

## ğŸ“„ License

MIT
